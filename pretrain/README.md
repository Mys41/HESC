
## DeepSpeed配置文件
`zero_optimization`包括了ZeRO的训练参数，在这个参数字典里，stage可以设置为1、2、3中的一个整数值，
用来表示ZeRO的划分等级；

`overlap_comm`设置了是否在计算和通信之间进行重叠。当设置为true时，表示在模型进行前向和反向传播的同时，也进行通信操作，以减少总的训练时间；

`contiguous_gradients`设置了是否使梯度在内存中连续。当设置为true时，表示将梯度存储在一块连续的内存区域中，这可以提高内存访问的效率；

`sub_group_size`设置了子组的大小。在进行通信操作时，ZeRO优化器会将所有的设备划分为多个子组，每个子组内的设备会进行集体通信；

`reduce_bucket_size`和`stage3_prefetch_bucket_size`这两个参数设置了进行通信操作时的桶大小。
在ZeRO优化器中，通信操作是以桶为单位进行的，每个桶包含了多个参数或梯度；

`stage3_param_persistence_threshold`设置了参数持久性的阈值。在ZeRO-3阶段，只有超过这个阈值的参数才会被持久地存储在设备上；

`stage3_max_live_parameters`和`stage3_max_reuse_distance`是ZeRO-3阶段控制模型参数缓存量的超参数，
其值越小，占用的显存量越小但通信成本会提高；

`stage3_gather_16bit_weights_on_model_save`用于控制ZeRO-3时存档点是否被分片，
如果设置为false则保存时会分片，后续使用时需要使用里面脚本进行合并，否则在保存时不会分片，但在训练保存存档点的时间会变长。

## ZeRO划分等级
ZeRO-1：执行优化器状态的划分，可以减少内存消耗到原来的1/4，同时保持通讯开销不变，数据并行度不受影响。

ZeRO-2：对优化器状态和梯度进行分片处理，实现了进一步的内存减少到原来的1/8，同时通讯开销和数据并行度仍然维持不变。

ZeRO-3：分片优化器状态、梯度和参数，内存减少的幅度和数据并行度成线性关系。在64个GPU（即Nd等于64情况下）的情况下，
内存消耗可以降低64倍。通讯量相对会增加50%。